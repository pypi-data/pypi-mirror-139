"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5296],{81788:(e,t,o)=>{o.d(t,{TZ:()=>s,u7:()=>i,B8:()=>l});var r=o(31069),n=o(68492);const a=(e,t,o)=>{let r=`api/v1/dashboard/${e}/filter_state`;return t&&(r=r.concat(`/${t}`)),o&&(r=r.concat(`?tab_id=${o}`)),r},s=(e,t,o,s)=>r.Z.put({endpoint:a(e,o,s),jsonPayload:{value:t}}).then((e=>e.json.message)).catch((e=>(n.Z.error(e),null))),i=(e,t,o)=>r.Z.post({endpoint:a(e,void 0,o),jsonPayload:{value:t}}).then((e=>e.json.key)).catch((e=>(n.Z.error(e),null))),l=(e,t)=>r.Z.get({endpoint:a(e,t)}).then((({json:e})=>JSON.parse(e.value))).catch((e=>(n.Z.error(e),null)))},14073:(e,t,o)=>{o.r(t),o.d(t,{MigrationContext:()=>x,default:()=>I});var r=o(67294),n=o(93185),a=o(61988),s=o(37703),i=o(5977),l=o(14114),u=o(38703),c=o(51995),d=o(74069),_=o(35932),f=o(11965);const h=(0,c.iK)(d.Z)`
  .modal-content {
    height: 900px;
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }

  .modal-header {
    flex: 0 1 auto;
  }

  .modal-body {
    flex: 1 1 auto;
    overflow: auto;
  }

  .modal-footer {
    flex: 0 1 auto;
  }

  .ant-modal-body {
    overflow: auto;
  }
`,m=({onClickReview:e,onClickSnooze:t,onHide:o,show:n,hideFooter:s=!1})=>(0,f.tZ)(h,{show:n,onHide:o,title:(0,a.t)("Ready to review filters in this dashboard?"),hideFooter:s,footer:(0,f.tZ)(r.Fragment,null,(0,f.tZ)(_.Z,{buttonSize:"small",onClick:t},(0,a.t)("Remind me in 24 hours")),(0,f.tZ)(_.Z,{buttonSize:"small",onClick:o},(0,a.t)("Cancel")),(0,f.tZ)(_.Z,{buttonSize:"small",buttonStyle:"primary",onClick:e},(0,a.t)("Start Review"))),responsive:!0},(0,f.tZ)("div",null,(0,a.t)("filter_box will be deprecated in a future version of Superset. Please replace filter_box by dashboard filter components.")));var p=o(67994),b=o(63389),E=o(50810),v=o(14505),O=o(40076),S=o(72570),y=o(61337),Z=o(69856),g=o(27600),R=o(23525),w=o(70695),D=o(52794),N=o(81788);const x=r.createContext(Z.Qi.NOOP);(0,O.Z)();const T=r.lazy((()=>Promise.all([o.e(1216),o.e(995),o.e(876),o.e(2671),o.e(1163),o.e(193),o.e(2745),o.e(818),o.e(452)]).then(o.bind(o,61003)))),C=document.title,I=()=>{const e=(0,s.I0)(),t=(0,s.v9)((e=>e.user)),{addDangerToast:o}=(0,l.e)(),{idOrSlug:c}=(0,i.UO)(),{result:d,error:_}=(0,p.QU)(c),{result:h,error:O}=(0,p.Es)(c),{result:I,error:z}=(0,p.JL)(c),k=(0,r.useRef)(!1),L=_||O,Q=Boolean(d&&h),F=(0,R.e)(g.KD.migrationState),P=(0,n.c)(n.T.ENABLE_FILTER_BOX_MIGRATION),{dashboard_title:$,css:j,metadata:A,id:B=0}=d||{},[M,H]=(0,r.useState)(F||Z.Qi.NOOP);if((0,r.useEffect)((()=>{const o=h&&h.some((e=>{var t;return"filter_box"===(null==(t=e.form_data)?void 0:t.viz_type)}));if(d&&(0,w.M)(d,t)){if(null!=A&&A.native_filter_configuration)return void H(P?Z.Qi.CONVERTED:Z.Qi.NOOP);if(o)if(P){if(F&&Object.values(Z.Qi).includes(F))return void H(F);const e=(0,y.rV)(y.dR.filter_box_transition_snoozed_at,{});if(Date.now()-(e[B]||0)<Z.Yd)return void H(Z.Qi.SNOOZED);H(Z.Qi.UNDECIDED)}else(0,n.c)(n.T.DASHBOARD_NATIVE_FILTERS)&&e((0,S.Dz)((0,a.t)("filter_box will be deprecated in a future version of Superset. Please replace filter_box by dashboard filter components.")))}}),[Q]),(0,r.useEffect)((()=>{B&&async function(){const t=(0,R.e)(g.KD.nativeFiltersKey);let o=t||{};const r=(0,R.e)(g.KD.nativeFilters);t&&(o=await(0,N.B8)(B,t)),r&&(o=r),Q&&(k.current||(k.current=!0,(0,n.c)(n.T.DASHBOARD_NATIVE_FILTERS_SET)&&e((0,D.pi)(B))),e((0,b.Y)(d,h,M,o)))}()}),[Q,M]),(0,r.useEffect)((()=>($&&(document.title=$),()=>{document.title=C})),[$]),(0,r.useEffect)((()=>j?(0,v.Z)(j):()=>{}),[j]),(0,r.useEffect)((()=>{z?o((0,a.t)("Error loading chart datasources. Filters may not work correctly.")):e((0,E.Fy)(I))}),[o,I,z,e]),L)throw L;return Q?(0,f.tZ)(r.Fragment,null,(0,f.tZ)(m,{show:M===Z.Qi.UNDECIDED,hideFooter:!P,onHide:()=>{H(Z.Qi.SNOOZED)},onClickReview:()=>{H(Z.Qi.REVIEWING)},onClickSnooze:()=>{const e=(0,y.rV)(y.dR.filter_box_transition_snoozed_at,{});(0,y.LS)(y.dR.filter_box_transition_snoozed_at,{...e,[B]:Date.now()}),H(Z.Qi.SNOOZED)}}),(0,f.tZ)(x.Provider,{value:M},(0,f.tZ)(T,null))):(0,f.tZ)(u.Z,null)}},14505:(e,t,o)=>{function r(e){const t="CssEditor-css",o=document.head||document.getElementsByTagName("head")[0],r=document.querySelector(`.${t}`)||function(e){const t=document.createElement("style");return t.className="CssEditor-css",t.type="text/css",t}();return"styleSheet"in r?r.styleSheet.cssText=e:r.innerHTML=e,o.appendChild(r),function(){r.remove()}}o.d(t,{Z:()=>r})},67994:(e,t,o)=>{o.d(t,{hb:()=>f,QU:()=>h,Es:()=>m,JL:()=>p});var r,n=o(22102),a=o(67294);!function(e){e.LOADING="loading",e.COMPLETE="complete",e.ERROR="error"}(r||(r={}));const s={status:r.LOADING,result:null,error:null};function i(e,t){return(0,a.useMemo)((()=>{if(e.status!==r.COMPLETE)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:r.ERROR,result:null,error:e}}}),[e,t])}const l=e=>e.result;function u(e){return i(function(e){const[t,o]=(0,a.useState)(s),i=(0,a.useRef)((()=>{}));return(0,a.useEffect)((()=>{o(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,n.Z)({method:"GET",endpoint:e})({}).then((e=>{t||o({status:r.COMPLETE,result:e,error:null})})).catch((e=>{t||o({status:r.ERROR,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}var c=o(15926);function d({owners:e}){return e?e.map((e=>`${e.first_name} ${e.last_name}`)):null}const _=o.n(c)().encode({columns:["owners.first_name","owners.last_name"],keys:["none"]});function f(e){return i(u(`/api/v1/chart/${e}?q=${_}`),d)}const h=e=>i(u(`/api/v1/dashboard/${e}`),(e=>({...e,metadata:e.json_metadata&&JSON.parse(e.json_metadata)||{},position_data:e.position_json&&JSON.parse(e.position_json)}))),m=e=>u(`/api/v1/dashboard/${e}/charts`),p=e=>u(`/api/v1/dashboard/${e}/datasets`)},61337:(e,t,o)=>{var r;function n(e,t){return s(e,t)}function a(e,t){i(e,t)}function s(e,t){try{const o=localStorage.getItem(e);return null===o?t:JSON.parse(o)}catch{return t}}function i(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch{}}o.d(t,{dR:()=>r,rV:()=>n,LS:()=>a,OH:()=>s,I_:()=>i}),function(e){e.filter_box_transition_snoozed_at="filter_box_transition_snoozed_at",e.chart_split_sizes="chart_split_sizes",e.controls_width="controls_width",e.datasource_width="datasource_width",e.is_datapanel_open="is_datapanel_open",e.homepage_chart_filter="homepage_chart_filter",e.homepage_dashboard_filter="homepage_dashboard_filter",e.homepage_collapse_state="homepage_collapse_state",e.homepage_activity_filter="homepage_activity_filter",e.sqllab__is_autocomplete_enabled="sqllab__is_autocomplete_enabled",e.explore__data_table_time_formatted_columns="explore__data_table_time_formatted_columns"}(r||(r={}))}}]);