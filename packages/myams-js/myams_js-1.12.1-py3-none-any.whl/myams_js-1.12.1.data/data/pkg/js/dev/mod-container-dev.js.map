{"version":3,"sources":["mod-container.js"],"names":["$","MyAMS","container","switchElementAttribute","action","link","params","require","then","cell","parents","icon","row","table","col","index","location","data","updateTarget","objectName","hint","attr","tooltip","replaceWith","ajax","post","object_name","attribute_name","result","status","xhr","state","addClass","handle_json","handleJSON","deleteElement","alert","bigBox","title","i18n","WARNING","message","CONFIRM_REMOVE","successLabel","CONFIRM","cancelLabel","BTN_CANCEL","deleteTarget","hasClass","DataTable","remove","draw","window","env","bundle","config","modules","push","console","debug"],"mappings":"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","sourcesContent":["/* global MyAMS */\n/**\n * MyAMS container management\n */\n\nconst $ = MyAMS.$;\n\n\nexport const container = {\n\n\t/**\n\t * Switch attribute of container element\n\t *\n\t * @param action\n\t */\n\tswitchElementAttribute: (action) => {\n\t\treturn function(link, params) {\n\t\t\tMyAMS.require('ajax', 'alert', 'i18n').then(() => {\n\t\t\t\tconst\n\t\t\t\t\tcell = link.parents('td'),\n\t\t\t\t\ticon = $('i', cell),\n\t\t\t\t\trow = cell.parents('tr'),\n\t\t\t\t\ttable = row.parents('table'),\n\t\t\t\t\tcol = $(`thead th:nth-child(${cell.index()+1})`, table);\n\t\t\t\tlet location = link.data('ams-location') || col.data('ams-location') ||\n\t\t\t\t\trow.data('ams-location') || table.data('ams-location') || '';\n\t\t\t\tif (location) {\n\t\t\t\t\tlocation += '/';\n\t\t\t\t}\n\t\t\t\tconst\n\t\t\t\t\tupdateTarget = link.data('ams-update-target') || col.data('ams-update-target') ||\n\t\t\t\t\t\trow.data('ams-update-target') || table.data('ams-update-target') ||\n\t\t\t\t\t\t'switch-element-attribute.json',\n\t\t\t\t\tobjectName = row.data('ams-element-name'),\n\t\t\t\t\thint = icon.attr('data-original-title') || icon.attr('title');\n\t\t\t\ticon.tooltip('hide')\n\t\t\t\t\t.replaceWith('<i class=\"fas fa-spinner fa-spin\"></i>');\n\t\t\t\tMyAMS.ajax.post(location + updateTarget, {\n\t\t\t\t\tobject_name: objectName,\n\t\t\t\t\tattribute_name: col.data('ams-attribute-name')\n\t\t\t\t}).then((result, status, xhr) => {\n\t\t\t\t\tlet icon = $('i', cell);\n\t\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\t\tif (result.state) {\n\t\t\t\t\t\t\ticon.replaceWith(`<i class=\"${col.data('ams-icon-on')}\"></i>`);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ticon.replaceWith(`<i class=\"${col.data('ams-icon-off')}\"></i>`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hint) {\n\t\t\t\t\t\t\ticon = $('i', cell);\n\t\t\t\t\t\t\ticon.addClass('hint')\n\t\t\t\t\t\t\t\t.attr('data-original-title', hint);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result.handle_json) {\n\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * Delete element from container\n\t *\n\t * @param action\n\t * @returns {(function(*, *): void)|*}\n\t */\n\tdeleteElement: (action) => {\n\t\treturn function(link, params) {\n\t\t\tMyAMS.require('ajax', 'alert', 'i18n').then(() => {\n\t\t\t\tMyAMS.alert.bigBox({\n\t\t\t\t\tstatus: 'danger',\n\t\t\t\t\ticon: 'fas fa-bell',\n\t\t\t\t\ttitle: MyAMS.i18n.WARNING,\n\t\t\t\t\tmessage: MyAMS.i18n.CONFIRM_REMOVE,\n\t\t\t\t\tsuccessLabel: MyAMS.i18n.CONFIRM,\n\t\t\t\t\tcancelLabel: MyAMS.i18n.BTN_CANCEL\n\t\t\t\t}).then((status) => {\n\t\t\t\t\tif (status !== 'success') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst\n\t\t\t\t\t\tcell = link.parents('td'),\n\t\t\t\t\t\trow = cell.parents('tr'),\n\t\t\t\t\t\ttable = row.parents('table'),\n\t\t\t\t\t\tcol = $(`thead th:nth-child(${cell.index()+1})`, table);\n\t\t\t\t\tlet location = link.data('ams-location') ||  col.data('ams-location') ||\n\t\t\t\t\t\trow.data('ams-location') || table.data('ams-location') || '';\n\t\t\t\t\tif (location) {\n\t\t\t\t\t\tlocation += '/';\n\t\t\t\t\t}\n\t\t\t\t\tconst\n\t\t\t\t\t\tdeleteTarget = link.data('ams-delete-target') || col.data('ams-delete-target') ||\n\t\t\t\t\t\t\trow.data('ams-delete-target') || table.data('ams-delete-target') ||\n\t\t\t\t\t\t\t'delete-element.json',\n\t\t\t\t\t\tobjectName = row.data('ams-element-name');\n\t\t\t\t\tMyAMS.ajax.post(location + deleteTarget, {\n\t\t\t\t\t\t'object_name': objectName\n\t\t\t\t\t}).then((result, status, xhr) => {\n\t\t\t\t\t\tif (result.status === 'success') {\n\t\t\t\t\t\t\tif (table.hasClass('datatable')) {\n\t\t\t\t\t\t\t\ttable.DataTable().row(row).remove().draw();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.remove();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (result.handle_json) {\n\t\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('container');\n\t} else {\n\t\tMyAMS.container = container;\n\t\tconsole.debug(\"MyAMS: container module loaded...\");\n\t}\n}\n"],"file":"mod-container-dev.js"}